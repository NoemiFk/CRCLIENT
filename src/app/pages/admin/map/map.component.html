<vex-page-layout mode="card">

  <vex-page-layout-header fxLayout="column" fxLayoutAlign="center start">
    <div [class.container]="layoutCtrl.value === 'boxed'"
         [class.px-gutter]="layoutCtrl.value === 'fullwidth'"
         class="w-full flex flex-col  justify-between"> <!-- sm:flex-row-->
      
      <h3  class="mb-0" *ngIf="isNew=='true'">Subir archivo de portafolio</h3> 
      <h3  class="mb-0"*ngIf="isNew!='true'"> Actualización de portafolio</h3> 
       </div>
  </vex-page-layout-header>

  <vex-page-layout-content [class.container]="layoutCtrl.value === 'boxed'"
                           [class.px-gutter]="layoutCtrl.value === 'fullwidth'"
                           class="-mt-6">
                          
                          
    <div class="card overflow-auto -mt-16" *ngIf="isNew=='true'">
      <p class="cursor-pointer pt-2 pl-4" (click)="back()" > <mat-icon class="pt-2"  [icIcon]="icBack"></mat-icon> <b> Regresar</b></p>

          <mat-horizontal-stepper>
            <mat-step label="Cargar Archivo" state="phone">
              <div style="padding: 20px;">

                <h4>Cargar Archivo</h4>
                <!--p>Carga aquí tu layout</p-->
                <p>1. El formato del archivo debe ser xlsx o csv. </p>
                <p>2. La primera fila debe ser el encabezcado, no deben exisitr columnas o filas vacias para poder subir el archivo con éxito.
                </p>
              </div>
              <div  class="text-center">

                <div class="spinner" *ngIf="active"></div>
                <div class="fileControl-wrapper text-center">
                  <br>
                    <button mat-flat-button color="primary">Seleccionar Archivo</button>
                  <input type="file" #uploadControl id="fileControlInput" (change)="onFileChange($event)" name="fileControlInput"
                    multiple="multiple"  />
              
                </div>
                <h3 *ngIf="jsonData.Datos.length && !active">El archivo seleccionado contiene</h3>
                <h2 *ngIf="jsonData.Datos.length && !active"> {{jsonData.Datos.length}} Registros</h2>
                <div id="output" *ngIf="false"></div>
                <div *ngIf="willDownload && false">
                  <a id="download"> Download JSON File </a>
                </div>
                
            </div>
              <div class="text-right" *ngIf="jsonData.Datos.length && !active">
                <button  mat-flat-button mat-button color="primary"  matStepperNext (click)="createRegister()">SUBIR ARCHIVO</button>
              </div>
            </mat-step>
            <mat-step label="Mapeo" >

              <br>
              <div class="w-full flex justify-between">
                <p class="flex-1">En esta etapa se debe realizar el mapeo de los campos del portafolio. El mapeo es necesario para seleccionar los campos que se requieren para las diferentes funcionalidades; recomendación para el Mapeo: </p>
                <button mat-raised-button color="primary" matStepperNext (click)="create()">GUARDAR MAPEO</button>
              </div>
              <br>
              <div class="alert alert-primary" role="alert">
                <mat-icon  [icIcon]="icInfo" 
                      class="pt-1"
                      ></mat-icon> 
                      <b>IMPORTANTE:</b> Te recomendamos leer y seguir las instrucciones en cada punto del encabezado.
              </div>
              
                <div class="alert alert-warning" role="alert"  *ngIf="alert3" >
                  <mat-icon  [icIcon]="icWarning" 
                      class="pt-1"
                      ></mat-icon> En el MAPEO debe asignar un campo ID Unico.
                </div>
                <div class="alert alert-warning" role="alert"  *ngIf="alert4" >
                  <mat-icon  [icIcon]="icWarning" 
                      class="pt-1"
                      ></mat-icon> Solo puedes seleccionar 10 criterios para segmentación..
                </div>
              
              <br>
              <br>
              <ng-template #popTemplate27><div>Segmentación: Seleccionar campos como Cartera Vencida, Por vencer, Fecha último pago, Estado, Producto evitar campos como nombre del cliente, dirección, Fecha de Nacimiento.</div></ng-template>
          
              <ng-template #popTemplate28><div>Comunicación: Seleccionar campos para personalización como nombre, dirección, cartera vencida, numero de cliente o contrato, referencia de pago.</div></ng-template>
          
              <ng-template #popTemplate29><div>Encabezado</div></ng-template>
              <ng-template #popTemplate029><div>Ejemplo de datos cargados </div></ng-template>
              <ng-template #popTemplate30><div>Portal: Seleccionar campos que el cliente puede visualizar como el desglose de su cartera vencida, nombre, numero de cliente o contrato, referencia de pago.</div></ng-template>
          
              <ng-template #popTemplate31><div>Aval: Seleccionar campos relacionados con el aval, Nombre, Dirección</div></ng-template>
          
              <ng-template #popTemplate32><div>Validacion de tipo de dato incluido.</div></ng-template>
          
              <div class="example-container" >
                <table mat-table [dataSource]="table" class="mat-elevation-z8 text-center table1"  style="width: 100%; " *ngIf="table.length">
          
                  <ng-container matColumnDef="Campo">
                    <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Campo</b> 
                      <mat-icon  [icIcon]="icInfo" 
                      [outsideClick]="true"
[popover]="popTemplate29"
                      placement="top"
                      class="pt-1"
                      ></mat-icon>
                    </th>
                    <td mat-cell *matCellDef="let element" class="text-center" > <b> {{element.map}} </b></td>
                  </ng-container>
                  <ng-container matColumnDef="Ejemplo">
                    <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Ejemplo</b> 
                      <mat-icon  [icIcon]="icInfo" 
                      [outsideClick]="true"
[popover]="popTemplate029"
                      placement="top"
                      class="pt-1"
                      ></mat-icon>
                    </th>
                    <td mat-cell *matCellDef="let element" class="text-center" > 
                      <p style="display: block;
                      white-space: nowrap;
                      overflow: hidden;
                      text-overflow: ellipsis;
                      width: 130px;">
                          {{element.ejemplo}}
                      </p> 
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Segmentación">
                    <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Segmentación</b> 
                      <mat-icon  [icIcon]="icInfo" 
                      [outsideClick]="true"
[popover]="popTemplate27"
                      placement="top"
                      class="pt-1"
                      ></mat-icon>
                    </th>
                    <td mat-cell *matCellDef="let element;let i = index;" class="text-center" > 
                      <mat-checkbox class="example-margin w-full text-center" [checked]="element.segmentation.status" ([ngModel])=" element.segmentation.status"
                      (change)="$event ? saveChange('segmentation',i) : null" [disabled]="element.segmentation.status == false &&  disableSegment">
                    </mat-checkbox>
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Comunicación">
                    <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Comunicación</b>
                      <mat-icon  [icIcon]="icInfo" 
                      [outsideClick]="true"
[popover]="popTemplate28"
                      placement="top"
                      class="pt-1"
                      ></mat-icon>  </th>
                    <td mat-cell *matCellDef="let element;let i = index;" class="text-center" > 
                      <mat-checkbox class="example-margin w-full text-center" [checked]="element.strategies.status" ([ngModel])=" element.strategies.status"
                      (change)="$event ? saveChange('strategies',i) : null">
                    </mat-checkbox>
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Portal">
                    <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Portal</b>  
                      <mat-icon  [icIcon]="icInfo" 
                      [outsideClick]="true"
[popover]="popTemplate30"
                      placement="top"
                      class="pt-1"
                      ></mat-icon>
                    </th>
                    <td mat-cell *matCellDef="let element;let i = index;" class="text-center" > 
                      <mat-checkbox class="example-margin w-full text-center" [checked]="element.customerPortal.status" ([ngModel])=" element.customerPortal.status"
                      (change)="$event ? saveChange('customerPortal',i) : null">
                    </mat-checkbox>
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Aval">
                    <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Aval</b>  
                      <mat-icon  [icIcon]="icInfo" 
                      [outsideClick]="true"
[popover]="popTemplate31"
                      placement="top"
                      class="pt-1"
                      ></mat-icon>
                    </th>
                    <td mat-cell *matCellDef="let element;let i = index;" class="text-center" > 
                      <mat-checkbox class="example-margin w-full text-center" [checked]="element.endorsement.status" ([ngModel])=" element.endorsement.status"
                      (change)="$event ? saveChange('endorsement',i) : null">
                    </mat-checkbox>
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Validación">
                    <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Validación</b> 
                      <mat-icon  [icIcon]="icInfo" 
                      [outsideClick]="true"
[popover]="popTemplate32"
                      placement="top"
                      class="pt-1"
                      ></mat-icon> </th>
                    <td mat-cell *matCellDef="let element" class="text-center" >
                      <select class="sm:ml-6" name="element.validations.type" style="background: transparent;" [(ngModel)]="element.validations.type">
                        <option value="no">Seleccione uno...</option>
                        <option value="id">ID Unico</option>
                        <option value="string">Texto</option>
                        <option value="number">Cantidad</option>
                        <option value="email">Mail</option>
                        <option value="phone">Número Telefónico</option>
                        <option value="date">Fecha</option>
                      </select>
                    </td>
                  </ng-container>
                
                  <tr mat-header-row *matHeaderRowDef="displayedColumnsA2;"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumnsA2;"></tr>
                </table>
              </div>
              <br>
              
              <div class="text-right">
                <button mat-button color="warn" matStepperPrevious (click)="return()">ATRAS</button>
                <button mat-raised-button color="primary"  matStepperNext (click)="create()">GUARDAR MAPEO</button>
              </div>
            </mat-step>
          
            <!-- Icon overrides. -->
            <ng-template matStepperIcon="phone">
              <mat-icon>call_end</mat-icon>
            </ng-template>
            <ng-template matStepperIcon="chat">
              <mat-icon>forum</mat-icon>
            </ng-template>
          </mat-horizontal-stepper>


    </div>
    <div class="card overflow-auto -mt-16" *ngIf="isNew=='false'">
      
      <div class="pt-4 pl-4 pr-4"  fxLayout="row" fxLayoutAlign="space-between center">
        <p *ngIf="created" class="cursor-pointer" (click)="back()"> <mat-icon class="pt-2" [icIcon]="icBack"></mat-icon> <b> Regresar</b></p>
        <p *ngIf="created">Fecha de creacion: <b> {{created | date}}</b></p>
        <!--p *ngIf="updated">Fecha de actualizacion: <b>{{updated | date}}</b></p-->
      </div>
      <mat-horizontal-stepper>
       <mat-step label="Actualizar Portafolio" state="phone">
          <div style="padding: 20px;">

            <h3>Subir Archivo de  actualización Portafolio</h3>
            <p>1. El formato del archivo debe ser xlsx o csv. </p>
            <p>2. La primera fila debe ser el encabezcado, no deben exisitr columnas o filas vacias para poder subir el archivo con éxito. 

          </div>
          <!--div  class="text-center">
            <div class="spinner"></div>

            <input type="file" (change)="onFileChange($event)" />
            <h3 *ngIf="jsonData.Datos.length">Datos Cargados</h3>
            <h2 *ngIf="jsonData.Datos.length"> {{jsonData.Datos.length}}</h2>
        </div-->
        <div class="spinner" *ngIf="active"></div>
        <div class="fileControl-wrapper text-center">
          <br>
            <button mat-flat-button color="primary" *ngIf="!active" >Seleccionar archivo de actualización</button>
          <input type="file" #uploadControl id="fileControlInput" (change)="onFileChange($event)" name="fileControlInput"
            multiple="multiple"  />
      
            <h5 *ngIf="jsonData.Datos.length && !active">Registros Cargados</h5>
            <h4 *ngIf="jsonData.Datos.length  && !active"> {{jsonData.Datos.length}}</h4>

            <div *ngIf="registros && actualizando">
              <br>
              <h5 *ngIf="datosactualizados">   Registros Nuevos: {{ datosactualizados}}</h5>
              <h5 *ngIf="registros">  Registros ya existentes:  {{registros}}</h5>
            </div>
        </div>
        <br>
        <div class="alert alert-danger" role="alert"  *ngIf="alert1" >
          Los datos mapeados de este archivo no corresponden a los datos cargados al crear el portafolio valide esta Información.
          Si desea subir el archivo, las configuraciones realizadas con el portafolio  seran eliminadas.
        </div>
        <div class="alert alert-warning" role="alert"  *ngIf="alert2" >
          Tu cartera actual contiene encabezados vacios, estos campos no se tomaran en cuenta, valida esta información.
        </div>
        
          <div class="text-right" *ngIf="jsonData.Datos.length && !active">
            <button mat-flat-button mat-button color="primary" matStepperNext (click)="updateDataMapeo()">ACTUALIZAR ARCHIVO</button>
            
          </div>
        </mat-step>
        <mat-step label="Mapeo" *ngIf="alert1" >

          <br>
          <div class="w-full flex justify-between">
            <p class="flex-1">En esta etapa se debe realizar el mapeo de los campos del portafolio. El mapeo es necesario para seleccionar los campos que se requieren para las diferentes funcionalidades; recomendación para el Mapeo: </p>
            <button mat-raised-button color="primary" matStepperNext (click)="create()">GUARDAR MAPEO</button>
          </div>
          <br>
          <div class="alert alert-primary" role="alert">
            <mat-icon  [icIcon]="icInfo" 
                  class="pt-1"
                  ></mat-icon> 
                  <b>IMPORTANTE:</b> Te recomendamos leer y seguir las instrucciones en cada punto del encabezado.
          </div>
          
            <div class="alert alert-warning" role="alert"  *ngIf="alert3" >
              <mat-icon  [icIcon]="icWarning" 
                  class="pt-1"
                  ></mat-icon> En el MAPEO debe asignar un campo ID Unico.
            </div>
            <div class="alert alert-warning" role="alert"  *ngIf="alert4" >
              <mat-icon  [icIcon]="icWarning" 
                  class="pt-1"
                  ></mat-icon> Solo puedes seleccionar 10 criterios para segmentación..
            </div>
          
          <br>
          <br>
          <ng-template #popTemplate27><div>Segmentación: Seleccionar campos como Cartera Vencida, Por vencer, Fecha último pago, Estado, Producto evitar campos como nombre del cliente, dirección, Fecha de Nacimiento.</div></ng-template>
      
          <ng-template #popTemplate28><div>Comunicación: Seleccionar campos para personalización como nombre, dirección, cartera vencida, numero de cliente o contrato, referencia de pago.</div></ng-template>
      
          <ng-template #popTemplate29><div>Encabezado</div></ng-template>
          <ng-template #popTemplate029><div>Ejemplo de datos cargados </div></ng-template>
          <ng-template #popTemplate30><div>Portal: Seleccionar campos que el cliente puede visualizar como el desglose de su cartera vencida, nombre, numero de cliente o contrato, referencia de pago.</div></ng-template>
      
          <ng-template #popTemplate31><div>Aval: Seleccionar campos relacionados con el aval, Nombre, Dirección</div></ng-template>
      
          <ng-template #popTemplate32><div>Validacion de tipo de dato incluido.</div></ng-template>
      
          <div class="example-container" >
            <table mat-table [dataSource]="table" class="mat-elevation-z8 text-center table1"  style="width: 100%; " *ngIf="table.length">
      
              <ng-container matColumnDef="Campo">
                <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Campo</b> 
                  <mat-icon  [icIcon]="icInfo" 
                  [outsideClick]="true"
[popover]="popTemplate29"
                  placement="top"
                  class="pt-1"
                  ></mat-icon>
                </th>
                <td mat-cell *matCellDef="let element" class="text-center" > <b> {{element.map}} </b></td>
              </ng-container>
              <ng-container matColumnDef="Ejemplo">
                <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Ejemplo</b> 
                  <mat-icon  [icIcon]="icInfo" 
                  [outsideClick]="true"
[popover]="popTemplate029"
                  placement="top"
                  class="pt-1"
                  ></mat-icon>
                </th>
                <td mat-cell *matCellDef="let element" class="text-center" > 
                  <p style="display: block;
                  white-space: nowrap;
                  overflow: hidden;
                  text-overflow: ellipsis;
                  width: 130px;">
                      {{element.ejemplo}}
                  </p> 
                </td>
              </ng-container>
              <ng-container matColumnDef="Segmentación">
                <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Segmentación</b> 
                  <mat-icon  [icIcon]="icInfo" 
                  [outsideClick]="true"
[popover]="popTemplate27"
                  placement="top"
                  class="pt-1"
                  ></mat-icon>
                </th>
                <td mat-cell *matCellDef="let element;let i = index;" class="text-center" > 
                  <mat-checkbox class="example-margin w-full text-center" [checked]="element.segmentation.status" ([ngModel])=" element.segmentation.status"
                  (change)="$event ? saveChange('segmentation',i) : null" [disabled]="element.segmentation.status == false &&  disableSegment">
                </mat-checkbox>
                </td>
              </ng-container>
              <ng-container matColumnDef="Comunicación">
                <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Comunicación</b>
                  <mat-icon  [icIcon]="icInfo" 
                  [outsideClick]="true"
[popover]="popTemplate28"
                  placement="top"
                  class="pt-1"
                  ></mat-icon>  </th>
                <td mat-cell *matCellDef="let element;let i = index;" class="text-center" > 
                  <mat-checkbox class="example-margin w-full text-center" [checked]="element.strategies.status" ([ngModel])=" element.strategies.status"
                  (change)="$event ? saveChange('strategies',i) : null">
                </mat-checkbox>
                </td>
              </ng-container>
              <ng-container matColumnDef="Portal">
                <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Portal</b>  
                  <mat-icon  [icIcon]="icInfo" 
                  [outsideClick]="true"
[popover]="popTemplate30"
                  placement="top"
                  class="pt-1"
                  ></mat-icon>
                </th>
                <td mat-cell *matCellDef="let element;let i = index;" class="text-center" > 
                  <mat-checkbox class="example-margin w-full text-center" [checked]="element.customerPortal.status" ([ngModel])=" element.customerPortal.status"
                  (change)="$event ? saveChange('customerPortal',i) : null">
                </mat-checkbox>
                </td>
              </ng-container>
              <ng-container matColumnDef="Aval">
                <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Aval</b>  
                  <mat-icon  [icIcon]="icInfo" 
                  [outsideClick]="true"
[popover]="popTemplate31"
                  placement="top"
                  class="pt-1"
                  ></mat-icon>
                </th>
                <td mat-cell *matCellDef="let element;let i = index;" class="text-center" > 
                  <mat-checkbox class="example-margin w-full text-center" [checked]="element.endorsement.status" ([ngModel])=" element.endorsement.status"
                  (change)="$event ? saveChange('endorsement',i) : null">
                </mat-checkbox>
                </td>
              </ng-container>
              <ng-container matColumnDef="Validación">
                <th mat-header-cell *matHeaderCellDef class="text-center uppercase" style="background: rgb(1, 90, 167);"> <b>Validación</b> 
                  <mat-icon  [icIcon]="icInfo" 
                  [outsideClick]="true"
[popover]="popTemplate32"
                  placement="top"
                  class="pt-1"
                  ></mat-icon> </th>
                <td mat-cell *matCellDef="let element" class="text-center" >
                  <select class="sm:ml-6" name="element.validations.type" style="background: transparent;" [(ngModel)]="element.validations.type">
                    <option value="no">Seleccione uno...</option>
                    <option value="id">ID Unico</option>
                    <option value="string">Texto</option>
                    <option value="number">Cantidad</option>
                    <option value="email">Mail</option>
                    <option value="phone">Número Telefónico</option>
                    <option value="date">Fecha</option>
                  </select>
                </td>
              </ng-container>
            
              <tr mat-header-row *matHeaderRowDef="displayedColumnsA2;"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumnsA2;"></tr>
            </table>
          </div>
          <br>
          
          <div class="text-right">
            <button mat-button color="warn" matStepperPrevious>ATRAS</button>
            <button mat-raised-button color="primary"  matStepperNext (click)="create()">GUARDAR MAPEO</button>
          </div>
        </mat-step>
        
        <!--mat-step label="Mapeo">

          <br>
          <p>Selecciona en la SIGUIENTE tabla los datos que desees utilizar en los SIGUIENTEs procesos de Collections Robot.</p>
          <br>
          <div class="card overflow-auto" style="max-height: 500px;">
            <div class="my-12 container"
            fxLayout="row"
            fxLayout.xs="column"
            fxLayoutAlign="start start"
            fxLayoutAlign.xs="start stretch"
            fxLayoutGap="24px">
            <div  fxFlex fxLayout="column">
              <b>Dato</b>
              <mat-list role="list">
                <mat-list-item role="listitem" *ngFor="let column of map"> {{column.datos}}</mat-list-item>
              </mat-list>
            </div>
            <div  fxFlex fxLayout="column">
              <b>Ejemplo</b>
              <mat-list role="list">
                <mat-list-item role="listitem" *ngFor="let column of map"> {{column.ejemplo}}</mat-list-item>
              </mat-list>
            </div>
            <div  fxFlex fxLayout="column">
              <b>Análisis</b>
              <mat-list role="list">
                <mat-list-item role="listitem" *ngFor="let column of analysis"> 
                  <mat-checkbox class="example-margin w-full text-center"
                  
                  [(ngModel)]="column.status">
                </mat-checkbox>
                </mat-list-item>
              </mat-list>
            </div>
            <div  fxFlex fxLayout="column">
              <b>Segmentación</b>
              <mat-list role="list">
                <mat-list-item role="listitem" *ngFor="let column of segmentation"> 
                  <mat-checkbox class="example-margin w-full text-center"
                  
                  [(ngModel)]="column.status"
                  >
                </mat-checkbox>
                </mat-list-item>
              </mat-list>
            </div>
            <div  fxFlex fxLayout="column">
              <b>Comunicación</b>
              <mat-list role="list">
                <mat-list-item role="listitem" *ngFor="let column of strategies"> 
                  <mat-checkbox class="example-margin w-full text-center"
                  
                  [(ngModel)]="column.status"
                  >
                </mat-checkbox>
                </mat-list-item>
              </mat-list>
            </div>
            <div  fxFlex fxLayout="column">
              <b>Portal</b>
              <mat-list role="list">
                <mat-list-item role="listitem" *ngFor="let column of customerPortal"> 
                  <mat-checkbox class="example-margin w-full text-center"
                  
                  [(ngModel)]="column.status"
                  >
                </mat-checkbox>
                </mat-list-item>
              </mat-list>
            </div>
            <div  fxFlex fxLayout="column">
              <b>Validación</b>
              <mat-list role="list">
                <mat-list-item role="listitem" *ngFor="let column of validations"> 
                  <mat-checkbox class="example-margin w-full text-center"
                  
                  [(ngModel)]="column.status"
                  >
                </mat-checkbox>
                  <select class="sm:ml-6" name="type"  >
                    <option value="no">Seleccione uno...</option>
                    <option value="Email">Mail</option>
                    <option value="number">Numero Telefonico</option>
                    <option value="date">Fecha</option>
                  </select>
                </mat-list-item>
              </mat-list>
            </div>
            </div>
          </div>
          <div class="text-right">
            <button mat-button matStepperPrevious>ATRAS</button>
            <button mat-button matStepperNext (click)="create()">Grabar</button>
          </div>
        </mat-step>
        <mat-step label="Validar Cartera" state="phone">
          <div style="padding: 20px;" class="text-center">
            <button>Validar</button>
        </div>
          <div class="text-right" *ngIf="jsonData.Datos.length">
            <button mat-button matStepperNext>SIGUIENTE</button>
          </div>
        </mat-step-->
        
      
        <!-- Icon overrides. -->
        <ng-template matStepperIcon="phone">
          <mat-icon>call_end</mat-icon>
        </ng-template>
        <ng-template matStepperIcon="chat">
          <mat-icon>forum</mat-icon>
        </ng-template>
      </mat-horizontal-stepper>
    </div>

  </vex-page-layout-content>

</vex-page-layout>

<mat-menu #columnFilterMenu="matMenu" xPosition="before" yPosition="below">
  <button (click)="toggleColumnVisibility(column, $event)" *ngFor="let column of columns"
          class="checkbox-item mat-menu-item">
    <mat-checkbox (click)="$event.stopPropagation()" [(ngModel)]="column.visible" color="primary">
      {{ column.label }}
    </mat-checkbox>
  </button>
</mat-menu>

